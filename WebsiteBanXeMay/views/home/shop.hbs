<section id="center" class="center_shop">
    <div class="center_om bg_back">
        <div class="container-xl">
            <div class="row center_o1">
                <div class="col-md-12">
                    <h1 class="text-white font_60">Shop</h1>
                    <h6 class="col_red mb-0">
                        <a class="text-light" href="/">Home</a>
                        <span class="mx-2 text-white-50">/</span> Shop
                    </h6>
                </div>
            </div>
        </div>
    </div>
</section>

<section id="blog" class="pt-5 pb-5">
    <div class="container-xl">
        <div class="row blog_1">
            <div class="col-md-9">
                <div class="blog_1_left border-end px-3">

                    <div class="shop_1lt row">
                        <div class="col-md-8">
                            <div class="shop_1ltl pt-2">
                                <p class="mb-0 text-black">
                                    Showing {{products.length}} of {{pagination.total}} results
                                    (Page {{pagination.page}} / {{pagination.totalPages}})
                                </p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="shop_1ltr">
                                <!-- Sort UI giữ nguyên (chưa xử lý sort ở backend) -->
                                <select class="form-select" aria-label="Default select example">
                                    <option selected="">Sort By Popularity</option>
                                    <option value="1">Sort By Latest</option>
                                    <option value="2">Sort By Rating</option>
                                    <option value="3">Sort By Trending</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- ====== DANH SÁCH SẢN PHẨM (DYNAMIC) ====== -->
                    <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 shop mt-4">
                        {{#if products.length}}
                            {{#each products}}
                                <div class="col">
                                    <div class="shop_left">
                                        <div class="shop_left1 position-relative">
                                            <div class="shop_left1_inner">
                                                <a href="/shop_detail/{{_id}}">
                                                    <img src="{{#if image}}{{image}}{{else}}/image/29.jpg{{/if}}" alt="abc" class="img-fluid">
                                                </a>
                                            </div>

                                            <!-- Badge giữ UI: dựa vào condition (Xe Cũ / không phải Xe Cũ) -->
                                            <div class="shop_left1_inner1 position-absolute top-0 p-3">
                                                {{#if (eq condition "Xe Cũ")}}
                                                    <b class="d-inline-block bg-white text-black p-1 px-3 font_14">Used</b>
                                                {{else}}
                                                    <b class="d-inline-block bg-black text-white p-1 px-3 font_14">New</b>
                                                {{/if}}
                                            </div>

                                            <div class="shop_left1_inner2 position-absolute w-100 h-100 bg_back top-0 text-center">
                                                <h5>
                                                    <a class="button px-3" href="/shop_detail/{{_id}}">
                                                        View detail <i class="fa fa-long-arrow-right ms-2"></i>
                                                    </a>
                                                </h5>
                                            </div>
                                        </div>

                                        <div class="shop_left2 mt-3">
                                            <!-- chỗ này template đang dùng "Lorem - Porta" -->
                                            <h6 class="fs-6 col_red">{{categoryName}} - {{year}}</h6>

                                            <ul class="mb-0 fs-5">
                                                <li>
                                                    <a class="justify-content-between d-flex" href="/shop_detail/{{_id}}">
                                                        {{title}}
                                                        <span>{{price}}VND</span>
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            {{/each}}
                        {{else}}
                            <div class="col">
                                <div class="alert alert-warning w-100">
                                    Không có sản phẩm phù hợp.
                                </div>
                            </div>
                        {{/if}}
                    </div>
                    <!-- ====== /DANH SÁCH SẢN PHẨM ====== -->

                    <!-- ====== PHÂN TRANG (DYNAMIC) ====== -->
                    {{#if pagination.total}}
                        {{#if (eq pagination.totalPages 1)}}
                            <!-- 1 trang thì không cần hiện paginate -->
                        {{else}}
                            <div class="blog_1_left2 mt-5">
                                <ul class="mt-3 mb-0 paginate text-center fw-bold">
                                    <li class="d-inline-block">
                                        <a class="border d-block" href="/shop?page={{pagination.prevPage}}&keyword={{keyword}}">
                                        <i class="fa fa-chevron-left"></i>
                                        </a>
                                    </li>

                                    {{#each pagination.pages}}
                                        <li class="d-inline-block">
                                            <a class="border d-block {{#if isCurrent}}active{{/if}}"
                                               href="/shop?page={{num}}&keyword={{../keyword}}">
                                            {{num}}
                                            </a>
                                        </li>
                                    {{/each}}

                                    <li class="d-inline-block">
                                        <a class="border d-block" href="/shop?page={{pagination.nextPage}}&keyword={{keyword}}">
                                        <i class="fa fa-chevron-right"></i>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        {{/if}}
                    {{/if}}
                    <!-- ====== /PHÂN TRANG ====== -->

                </div>
            </div>

            <div class="col-md-3">
                <div class="blog_1_right">

                    <!-- SEARCH (đổi từ button type=button thành form GET) -->
                    <div class="blog_1_right1">
                        <form method="get" action="/shop">
                            <div class="input-group">
                                <input type="text" class="form-control" name="keyword" value="{{keyword}}" placeholder="Search Keyword">
                                <span class="input-group-btn">
                                    <button class="btn btn-primary bg_red border-0 rounded-0 p-3 px-4" type="submit">
                                        <i class="fa fa-search"></i>
                                    </button>
                                </span>
                            </div>
                        </form>
                    </div>

                    <!-- Các khối filter/categories/latest/tags GIỮ NGUYÊN template -->
                    <div class="shop_pg1r1  mt-5 center_sm">
                        <h4 class="mb-4 border_thick ps-3">FILTER BY PRICE</h4>
                        <label for="customRange3" class="form-label fw-bold">Range 1% to 100%</label>
                        <input type="range" class="form-range" min="0" max="5" step="0.5" id="customRange3">
                        <h6 class="mb-0 mt-3"><a class="button" href="/shop">Filter <i class="fa fa-long-arrow-right ms-2"></i></a></h6>
                    </div>

                    <div class="blog_1_right1 mt-5">
                        <h4 class="mb-4 border_thick ps-3">CATEGORIES</h4>
                        <ul class="mb-0">
                            <li class="border-bottom pb-2 mb-2"><a class="justify-content-between d-flex" href="#">HELMETS <span>(2)</span></a></li>
                            <li class="border-bottom pb-2 mb-2"><a class="justify-content-between d-flex" href="#">Fast <span>(3)</span></a></li>
                            <li class="border-bottom pb-2 mb-2"><a class="justify-content-between d-flex" href="#">LEATHER <span>(4)</span></a></li>
                            <li class="border-bottom pb-2 mb-2"><a class="justify-content-between d-flex" href="#">Quality <span>(1)</span></a></li>
                            <li class="border-bottom pb-2 mb-2"><a class="justify-content-between d-flex" href="#">Moto <span>(5)</span></a></li>
                            <li class="border-bottom pb-2 mb-2"><a class="justify-content-between d-flex" href="#">Trackday <span>(9)</span></a></li>
                            <li class="border-bottom pb-2 mb-2"><a class="justify-content-between d-flex" href="#">Sound <span>(7)</span></a></li>
                            <li><a class="justify-content-between d-flex" href="#">Speed <span>(6)</span></a></li>
                        </ul>
                    </div>

                    <div class="blog_1_right1 mt-5">
                        <h4 class="mb-4 border_thick ps-3">LATEST Products</h4>
                        <ul class="mb-0">
                            <li class="d-flex px-3 justify-content-between">
                                <span class="flex-column">
                                    <span class="text-warning font_14">
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star-half-alt"></i>
                                    </span>
                                    <b class="mt-2 d-block"><a href="#">Sem Augue</a></b>
                                    <span class="mb-0 col_red fw-bold d-block mt-2">
                                        <span class="text-decoration-line-through fw-normal text-muted me-1">$59.00</span> $49.00
                                    </span>
                                </span>
                                <a href="#"><img width="70" alt="abc" src="/image/10.jpg"></a>
                            </li>
                            <li><hr></li>
                            <li class="d-flex px-3 justify-content-between">
                                <span class="flex-column">
                                    <span class="text-warning font_14">
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star-half-alt"></i>
                                    </span>
                                    <b class="mt-2 d-block"><a href="#">Lorem Amet</a></b>
                                    <span class="mb-0 col_red fw-bold d-block mt-2">
                                        <span class="text-decoration-line-through fw-normal text-muted me-1">$55.00</span> $42.00
                                    </span>
                                </span>
                                <a href="#"><img width="70" alt="abc" src="/image/11.jpg"></a>
                            </li>
                            <li><hr></li>
                            <li class="d-flex px-3 justify-content-between">
                                <span class="flex-column">
                                    <span class="text-warning font_14">
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star-half-alt"></i>
                                    </span>
                                    <b class="mt-2 d-block"><a href="#">Nulla Quis</a></b>
                                    <span class="mb-0 col_red fw-bold d-block mt-2">
                                        <span class="text-decoration-line-through fw-normal text-muted me-1">$50.00</span> $47.00
                                    </span>
                                </span>
                                <a href="#"><img width="70" alt="abc" src="/image/12.jpg"></a>
                            </li>
                        </ul>
                    </div>

                    <div class="blog_1_right1 mt-5">
                        <h4 class="mb-4 border_thick ps-3">Tags</h4>
                        <ul class="mb-0 tags">
                            <li class="d-inline-block"><a href="#">ABSTRACT</a></li>
                            <li class="d-inline-block"><a href="#">Apps</a></li>
                            <li class="d-inline-block"><a href="#">ART</a></li>
                            <li class="d-inline-block"><a href="#">Blogging</a></li>
                            <li class="d-inline-block"><a href="#">CREATIV</a></li>
                            <li class="d-inline-block"><a href="#">Future</a></li>
                            <li class="d-inline-block"><a href="#">MOTO SPORT</a></li>
                            <li class="d-inline-block"><a href="#">Trackday</a></li>
                        </ul>
                    </div>

                </div>
            </div>

        </div>
    </div>
</section>